<script>
  async function loadValine() {
    if (typeof Valine === "function") {
      var valine = new Valine({
        el: '.valine',
        appId: '<%= theme.valine.appId %>',
        appKey: '<%= theme.valine.appKey %>',
        placeholder: '<%= theme.valine.placeholder %>',
        visitor: <%= theme.valine.visitor %>,
        verify: <%= theme.valine.verify %>,
        recordIP: <%= theme.valine.recordIP %>,
        serverURLs: '<%= theme.valine.serverURLs %>',
        requiredFields: '<%= theme.valine.requiredFields %>'.split(','),
        path: window.location.pathname,
      });
    }
    else {
      loadScript("//code.bdstatic.com/npm/leancloud-storage@4.12.0/dist/av-min.js", () => { loadScript('<%- theme.cdn.valine.js %>', loadValine); })
    }
  };
</script>
<script class="pjax-reload">
  if(getRealPath()!=="/"){
    loadValine();
  }
</script>